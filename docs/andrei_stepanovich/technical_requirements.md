# 1. Цель проекта

Цель проекта — разработать вирутального помощника по документообороту, 
в виде Telegram бота. Которому можно будет отправлять файлы, находить 
нужные документы внутри чата, а также давать простые команды. Робот работает
с системой docs.wordok.by скажет дубликат в виде помощника, системы.

Весь функционал, это по сути дубликат самой системы, только его можно 
выпонлять с помощью Telegram бота

# 2. Описание системы

Система состоит из следующих основных функциональных блоков:

1. Подключение к телеграму, авторизация
2. Команды для пользователя
3. Список команд Telegram и их функционал

## 2.1. Типы пользователей

Система предусматривает один тип пользователей системы: пользователь.
Пользователь может загружать документы в рамках зарегистрированного аккаунта,
а также находить необходимый документ, по командам, с помощью Telegram чата.


## 2.2. Подключение к телеграму, авторизация

После того как мы нажали /Старт в роботе, нам робот должен предлагать написать 
секретный токен для авторизации, который можно получить в личном кабинете, на 
стороне сервера.

После того как мы написали токен, робот должен находить пользвателя который имеет 
данный токен, и уже сохранять данный чат в нашей базе, а также сообщать ответ в 
телеграме о статусе авторизации. ( авторизован - "пользователь с токеном Оля подключен." или ошибка - "пользователь с токеном не найден." ) 


## 2.3. Список команд Telegram и их функционал

Пользователь после аутентификации (подключения к телеграм боту) получает доступ к 
командам. Этот функционал состоит из
следующих команд:

```
1. /go - Бери в работу
2. /search - Найти по тегу
3. /edit - Изменить документ
4. /report - Отчет за период (дата от-до)
```

### 2.3.1. Загрузка документов - Команда "Бери в работу"

Данный блок имеет собой дополнительную функциональность, которая состоит из:

```
1. Сообщение в виде ответа на классификатор
2. Команда "/ok - Все хорошо"
```

Загрузка документов осуществляется с помощью чата, пользователю необходимо 
отправить документы в чат, а также сообщить роботу, что документы загружены 
и можно начать их обрабатывать. Сообщить роботу о том что документы можно 
принимать в обработку можно с помощью команды "/go - Бери в работу".

При загрузке документов группой или по отдельности, они должны сохранятся в 
базе под режимом ожидания, чтобы после команды сервер смог быстро взять их в работу.

Когда отправлена команда роботу, должен вызываться хук который делает из базы выборку всех 
документов, и начать выполнять функции, которые сделаны с помощью самого проекта.
После отправки команды, робот должен отвечать что он принял в работу, а также уведомлять
о статусе работы, в случае если ошибка, предлагать ссылку для редактирования.
Если успешно, сообщать о количестве документов и классов которые оно распознало, и ссылкой для редактирования
В случае если пользователь отправил команду "/ok - Все хорошо", тогда робот делает второй шаг, 
после классификации, извлекает нужную информацию


#### 2.3.1.1. Сообщение в виде ответа на классификатор

После успешного распознавания, мы пишем пользователю сообщение об успехе, а также в виде 
списка отправляет классы которые оно смогло распознать, категорию документа, и количество файлов
в данной категории. Пример сообщения:

```
Документы сохранены, вот список документов которые удалось распознать:
 - CMR - 1 шт.
 - Счет-Фактура - 1 шт.
 - РЖД - 4 шт.
 
Категория задачи: РЖД форма.
Редактировать класс можно по этой ссылке: http://docs.wordok.by/tasks/?=???

Чтобы отправить файлы на следующий файл обработки, отправь команду "/ok - Все хорошо"
```


#### 2.3.1.2. Команда "/ok - Все хорошо"

Данная команда подтвержает серверу о том что можно выполнять функцию извлечения информации.
Функция извлечения информации - это функционал, прописан индивидуально для аккаунта.


### 2.3.2. Поиск документа по тегам - Команда "Найти по тегу"

Вместе с командой "/search" необходимо указать тег, по которому должны находится документы.
В случае успеха, оно должно давать ответом данные файлы. Если ничего не найдено, оно должно 
сообщать о том что ничего нет.
Поиск должен происходить методом %LIKE%, данный метод это поиск документов которые содержит ключ
который внес пользователь.


### 2.3.3. Редактирование документа - Команда "Изменить документ"

После ввода команды "/edit" пользователю необходимо внести тег или id документа,
который необходимо редактировать. После чего если данный документ найден, робот должен предложить
загрузить новый документ, который заменит текущий.

**Данный функционал необходимо реализовать по мере необходимости, потому что здесь пока 
очень много непредвиденных нюансов, но идея должна быть**


### 2.3.4. Генерация отчета, документов в архив за период - Команда "Отчет за период (дата от-до)"

Вместе с командой "/report" необходимо указать даты от и до периода, в которые формировать отчеты, 
также можно учитывать 3 параметром, это категорию документа.

Даты принимаются в следующем формате (пример):

 - d.m по d.m (20.07 по 30.08), по дефолту текущий год
 - d.m.Y по d.m.Y (20.07.2022 по 30.08.2022)
 - d.m.y по d.m.y (20.07.22 по 30.08.22)
 - d n по d n ( 20 июля по 30 августа ), по дефолту текущий год
 - d n Y по d n Y ( 20 июля 2022 по 30 августа 2022)
 - d n y по d n y ( 20 июля 22 по 30 августа 22)

На примере выход выборки должен быть: 20.07.2022 по 30.08.2022.
В случае если дата указана неверно, выдавать ошибку. Если дата указана верно,
но документы  не найдены, писать ответ:

```
за указанный период 20.07.2022 - 30.08.2022 документов на найдено!
```

В случае если дата указана верно, и документы найдены. Выдавать архив, в который размещаем 
весь пакет найденных документов
